# 开发 TodoList（测试平台）

更新时间：2026-02-13

## 项目背景与目标
- 本项目是一个接口自动化测试平台，核心是把 API 请求沉淀为“可复用测试用例”，并支持数据驱动和场景编排。
- 平台目标是支持从单接口验证扩展到完整业务流程回归，例如：登录 -> 创建订单 -> 支付。
- 当前开发重点是先打通“用例管理 + 数据集管理 + 场景编排 + 执行记录”主链路，再逐步完善断言、报告、权限与 CI 集成。

## 状态说明
- `[ ]` 未开始
- `[-]` 进行中
- `[x]` 已完成

## M0 基础设施与建模
- `[x]` `uv` 依赖管理接入（`pyproject.toml` / `uv.lock`）
- `[x]` ORM 从 `tortoise` 迁移到 `SQLAlchemy async`
- `[x]` `Alembic` 迁移体系接入
- `[x]` 生成首个迁移版本
- `[x]` 测试用例/场景核心模型落地（含数据驱动数据集）

## M1 测试用例模块（ApiRequest）
- `[x]` 定义用例模块 Pydantic 入参/出参 Schema
- `[x]` 新增用例接口（支持基础模板字段）
- `[x]` 编辑用例接口（含状态、可见性、执行权限字段）
- `[x]` 用例详情接口
- `[x]` 用例分页列表（按状态/名称/创建人筛选）
- `[x]` 用例软删除接口

## M2 数据驱动模块（ApiRequestDataset）
- `[x]` 新增数据集接口（绑定 `request_id`）
- `[x]` 编辑数据集接口
- `[x]` 数据集列表接口（按 `request_id`）
- `[x]` 设置默认数据集接口（同用例唯一）
- `[x]` 启用/禁用数据集接口
- `[x]` 数据集删除接口

## M3 测试场景模块（TestScenario）
- `[ ]` 场景 CRUD 接口
- `[ ]` 场景步骤（`TestScenarioCase`）增删改查
- `[ ]` 场景步骤排序（`step_no`）调整接口
- `[ ]` 场景步骤数据集策略配置（`request_default/single/all`）

## M4 执行引擎
- `[ ]` 封装 HTTP 执行器（建议 `httpx.AsyncClient`）
- `[ ]` 合并参数策略：环境变量 + 用例模板 + 数据集覆盖
- `[ ]` 单用例执行接口（支持指定数据集）
- `[ ]` 场景执行接口（顺序执行）
- `[ ]` 失败中断策略（场景级/步骤级）
- `[ ]` 执行结果落库（`ApiRequestRun`）

## M5 断言与结果分析
- `[ ]` 断言模型设计（状态码/JSONPath/文本匹配）
- `[ ]` 断言执行与失败原因回传
- `[ ]` 运行结果详情接口（请求快照、响应、耗时、错误）
- `[ ]` 场景执行报告汇总

## M6 权限与可见性
- `[ ]` 公共可见用例访问规则（`is_public_visible`）
- `[ ]` 仅创建者执行规则（`creator_only_execute`）
- `[ ]` 复制生成用例标记逻辑（`is_copied_case`）

## M7 质量保障
- `[-]` 模块级单元测试（schema/service）- 已覆盖用例/数据集路由核心流程
- `[-]` 接口集成测试（关键 happy path + 异常 path）- 已接入真实 MySQL/Redis（用例/数据集模块）
- `[ ]` 基础审计日志（创建/编辑/执行）

## 当前进行中
- `[-]` M3 测试场景模块开发准备中（场景与步骤 CRUD）

## 下一步（建议）
- `[ ]` 实现 M3（场景 CRUD + 场景步骤 CRUD + 排序 + 数据集策略）
